# PRD: 오리온 파이류 점유율 분석 시스템

## 1. 개요

### 1.1 프로젝트명
**pie_project** - 오리온 파이류 매대 점유율 분석 도구

### 1.2 목적
매대 사진에서 오리온 파이류 제품을 검출하고, 각 파이 브랜드별 점유율을 대시보드 형태로 시각화한다.

### 1.3 배경
- 기존 pingu 프로젝트는 57개 브랜드를 분류하여 정확도가 낮았음
- 파이류 8개 브랜드로 범위를 축소하여 분류 정확도 향상 기대
- SKU 수에 따른 클래스 불균형 문제도 브랜드 수 축소로 완화 가능

## 2. 대상 브랜드 (8개)

| 번호 | 브랜드명 | 비고 |
|------|----------|------|
| 1 | 초코파이 | 오리온 대표 파이 |
| 2 | 참붕어빵 | |
| 3 | 카스타드 | (신카스타드) |
| 4 | 쌀 카스테라 | |
| 5 | 마켓오 리얼브라우니 | |
| 6 | 케익오뜨 | |
| 7 | 후레쉬베리 | |
| 8 | 쉘위 | |

## 3. 기능 요구사항

### 3.1 이미지 검출
- 매대 사진 업로드 시 개별 상품 자동 검출
- DETR ResNet-50 (SKU110K) 모델 사용 (facing-analyzer 검증 완료)

### 3.2 파이 브랜드 분류
- 검출된 상품 중 오리온 파이류 8개 브랜드 분류
- 파이류가 아닌 상품은 "기타"로 분류
- MobileNetV3 기반 9클래스 분류기 (8개 파이 + 기타)

### 3.3 점유율 계산
- **Facing 기반 점유율**: 검출된 파이 개수 / 전체 검출 개수 × 100
- **브랜드별 점유율**: 각 파이 브랜드 개수 / 전체 파이 개수 × 100
- **면적 기반 점유율** (옵션): bbox 면적 비율로 계산

### 3.4 대시보드
- 업로드된 매대 사진에 검출 결과 시각화 (bbox 표시)
- 오리온 파이류 전체 점유율 표시
- 브랜드별 점유율 차트 (파이 차트 또는 막대 차트)
- Gradio 기반 웹 UI

## 4. 비기능 요구사항

### 4.1 성능
- 이미지 1장 처리 시간: 10초 이내 (CPU 기준)
- 분류 정확도 목표: 85% 이상

### 4.2 사용성
- 단일 페이지 대시보드
- 드래그 앤 드롭 이미지 업로드
- 결과 즉시 확인 가능

## 5. 기술 스택

| 구분 | 기술 |
|------|------|
| 검출 모델 | DETR ResNet-50 (isalia99/detr-resnet-50-sku110k) |
| 분류 모델 | MobileNetV3 Small (9클래스) |
| 프레임워크 | PyTorch, Transformers |
| UI | Gradio |
| 언어 | Python 3.10+ |

## 6. 마일스톤

| 단계 | 작업 | 상태 |
|------|------|------|
| 1 | 프로젝트 구조 및 문서 작성 | 진행중 |
| 2 | 파이 브랜드 학습 데이터 수집 (crop 이미지 분류) | 대기 |
| 3 | 9클래스 분류기 학습 | 대기 |
| 4 | 검출 + 분류 파이프라인 구현 | 대기 |
| 5 | Gradio 대시보드 구현 | 대기 |
| 6 | 테스트 및 검증 | 대기 |

## 7. 관련 프로젝트

- **pingu**: 57개 브랜드 점유율 분석 (보류)
- **facing-analyzer**: 초코파이 facing 카운터 (DETR 검출기 검증용)
- **crop_Project**: 학습 데이터 crop 도구 (51,074장 생성 완료)
